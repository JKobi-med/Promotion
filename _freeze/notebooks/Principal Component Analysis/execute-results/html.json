{
  "hash": "cd95c53f6767d1fe6081aa99565b63d4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Principal Component Analysis\"\nauthor: \"Jonas J.R. Koberschinski\"\n---\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\n#| include: false\n# set working directory\nsetwd('/Users/kobi/Desktop/Promotionsdatananalyse mit Excel und Martin')\n\n#data set with all CpGs in columns for EDA and PCA\nlibrary(readxl)\n\n# load data\n ## BDNF\nbdnf <- read_excel(\"Rohdaten/BDNF_Neuroplastizität_Alter_CpGs_ohne_m11_und_p36_mit_verhalten_vollständig.xlsx\")\nbdnf[1:5,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 44\n  TraceFileName     ID Standort Zeitpunkt_als_Zahl Zeitpunkt Platte Group Gruppe\n  <chr>          <dbl>    <dbl>              <dbl> <chr>     <chr>  <chr> <chr> \n1 BDNF-C1_001_0…     1        0                  1 T0        Pl1    Cont… Contr…\n2 BDNF-C1_001_0…     1        0                  2 T1        Pl2    Cont… Contr…\n3 BDNF-C1_002_0…     2        0                  1 T0        Pl1    Piano Piano \n4 BDNF-C1_002_0…     2        0                  2 T1        Pl2    Piano Piano \n5 BDNF-C1_002_0…     2        0                  3 T2        Pl3    Piano Piano \n# ℹ 36 more variables: Gruppe_als_zahl <dbl>, Koordinate <chr>, m148 <dbl>,\n#   m111 <dbl>, m087 <dbl>, m066 <dbl>, m058 <dbl>, m039 <dbl>, m035 <dbl>,\n#   m024 <dbl>, p018 <dbl>, p020 <dbl>, Code <chr>, Sex <chr>, Age_start <dbl>,\n#   B03a_sleep_quality <dbl>, B03b_sleep_duration <chr>,\n#   B03c_sleep_to_recover <chr>, B09a_groesse <dbl>, B09b_gewicht <dbl>,\n#   B14a_rauchen <dbl>, rauchen <dbl>, B14d_wie_viele_zigaretten <chr>,\n#   B14b_rauchen_anfang <dbl>, B14c_raucherjahre <dbl>, …\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| include: false\n ##Tau\ntau <- read_excel(\"Rohdaten/TAU_CpGs_mit_verhalten_ohne_p61_p59_p34_p29.xlsx\")\ntau[1:5,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 380\n  TraceFileName          ID    Zeit  ID_Pl4_Zeit VP_plus_zeitpunkt Platte Gruppe\n  <chr>                  <chr> <chr> <chr>                   <dbl> <chr>  <chr> \n1 TAU-C1_1_T0_Pl1_Tau_C… 1     T0    1                         101 1      Contr…\n2 TAU-C1_1_T1_Pl2_Tau_C… 1     T1    1                         102 2      Contr…\n3 TAU-C1_2_T0_Pl1_Tau_P… 2     T0    2                         201 1      Piano \n4 TAU-C1_2_T1_Pl2_Tau_P… 2     T1    2                         202 2      Piano \n5 TAU-C1_2_T2_Pl3_Tau_P… 2     T2    2                         203 3      Piano \n# ℹ 373 more variables: Koordinate <chr>, m337 <dbl>, m331 <dbl>, m323 <dbl>,\n#   m315 <dbl>, m310 <dbl>, m306 <dbl>, m300 <dbl>, m293 <dbl>, m287 <dbl>,\n#   m277 <dbl>, m249 <dbl>, m219 <dbl>, m210 <dbl>, m207 <dbl>, m187 <dbl>,\n#   m181 <dbl>, m172 <dbl>, m152 <dbl>, m147 <dbl>, m111 <dbl>, m109 <dbl>,\n#   m105 <dbl>, m100 <dbl>, m95 <dbl>, m93 <dbl>, m91 <dbl>, m87 <dbl>,\n#   m85 <dbl>, m80 <dbl>, m73 <dbl>, m70 <dbl>, m68 <dbl>, m58 <dbl>,\n#   m53 <dbl>, m41 <dbl>, m39 <dbl>, m28 <dbl>, m25 <dbl>, m16 <dbl>, …\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| include: false\n ## PSD95\npsd95 <- read_excel(\"Rohdaten/PSD95_CpGs_mit_verhalten_gr̨ößer.xlsx\")\npsd95[1:5,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 376\n  TraceFileName          ID    Zeitpunkt_als_zahle VP_plus_zeitpunkt ID_Pl4_Zeit\n  <chr>                  <chr>               <dbl>             <dbl> <chr>      \n1 PSD95-C1_1_T0_Pl1_PSD… 1                       1               101 1          \n2 PSD95-C1_1_T1_Pl2_PSD… 1                       2               102 1          \n3 PSD95-C1_2_T0_Pl1_PSD… 2                       1               201 2          \n4 PSD95-C1_2_T1_Pl2_PSD… 2                       2               202 2          \n5 PSD95-C1_2_T2_Pl3_PSD… 2                       3               203 2          \n# ℹ 371 more variables: Zeitpunkt <chr>, Platte <chr>, Gruppe <chr>,\n#   Koordinate <chr>, m465 <dbl>, m418 <dbl>, m405 <dbl>, m400 <dbl>,\n#   m395 <dbl>, m392 <dbl>, m349 <dbl>, m340 <dbl>, m329 <dbl>, m326 <dbl>,\n#   m294 <dbl>, m291 <dbl>, m284 <dbl>, m282 <dbl>, m254 <dbl>, m249 <dbl>,\n#   m236 <dbl>, m226 <dbl>, m199 <dbl>, m193 <dbl>, m176 <dbl>, m165 <dbl>,\n#   m163 <dbl>, m155 <dbl>, m150 <dbl>, m124 <dbl>, m113 <dbl>, m92 <dbl>,\n#   m83 <dbl>, m77 <dbl>, m69 <dbl>, m49 <dbl>, m35 <dbl>, m31 <dbl>, …\n```\n\n\n:::\n:::\n\n\n## BDNF\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncpg_bdnf <- bdnf[11:20]\npca_bdnf <- prcomp(na.omit(cpg_bdnf), scale = TRUE)\n\n## plot pc1 and pc2\nplot(pca_bdnf$x[,1], pca_bdnf$x[,2])\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\n## make a scree plot\npca_bdnf_var <- pca_bdnf$sdev^2\npca_bdnf_var_per <- round(pca_bdnf_var/sum(pca_bdnf_var)*100, 1)\n\nbarplot(pca_bdnf_var_per, main=\"BDNF Scree Plot\", xlab=\"Principal Component\", ylab=\"Percent Variation\")\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\n## now make a fancy looking plot that shows the PCs and the variation:\nlibrary(ggplot2)\n\n\npca_bdnf_data <- as.data.frame(pca_bdnf$x)\npca_bdnf_data$ID <- rownames(pca_bdnf)\n\npca_bdnf_data[1:3,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         PC1         PC2        PC3         PC4         PC5         PC6\n1 -0.4983982 -0.09625517  0.5289260 -0.09502929  0.71613262  0.05692434\n2  1.1720441  0.18159948  0.4378651 -0.38193259  0.06752459 -0.05879165\n3 -2.0353002  2.30841912 -1.4098291 -0.36238449 -0.04653962 -1.37059444\n          PC7         PC8         PC9       PC10\n1 -0.15799882 -0.96874552 -0.73151124  0.6833330\n2  0.30117815 -0.09332618 -0.04401237  0.3197704\n3 -0.05712553 -0.44440554 -1.23228847 -1.4763906\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggplot(pca_bdnf_data, aes(PC1, PC2)) +\n  geom_point() +\n  xlab(paste(\"PC1 - \", pca_bdnf_var_per[1], \"%\", sep=\"\")) +\n  ylab(paste(\"PC2 - \", pca_bdnf_var_per[2], \"%\", sep=\"\")) +\n  theme_bw() +\n  ggtitle(\"BDNF PCA Graph\")\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nbdnf_loading_scores <- pca_bdnf$rotation[,1]\nbdnf_methylation_scores <- abs(bdnf_loading_scores) # what to do of bdnf_methylation_scores?\n  \nlibrary(ggfortify)\npca_bdnf_res <- prcomp(na.omit(bdnf[c(11:20)]), scale = TRUE)\n\nautoplot(pca_bdnf_res, data = na.omit(bdnf[c(1:20)]), colour = 'Zeitpunkt',\n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nautoplot(pca_bdnf_res, data = na.omit(bdnf[c(1:20)]), colour = 'Gruppe', \n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-2-5.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nautoplot(pca_bdnf_res, data = na.omit(bdnf[c(1:22)]), colour = 'Sex', \n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-2-6.png){width=672}\n:::\n:::\n\n\n\n## Tau\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncpg_tau <- tau[c(9:57)]\npca_tau <- prcomp(na.omit(cpg_tau), scale = TRUE)\n\n## plot pc1 and pc2\nplot(pca_tau$x[,1], pca_tau$x[,2])\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\n## make a scree plot\npca_tau_var <- pca_tau$sdev^2\npca_tau_var_per <- round(pca_tau_var/sum(pca_tau_var)*100, 1)\n\nbarplot(pca_tau_var_per, main=\"Tau Scree Plot\", xlab=\"Principal Component\", ylab=\"Percent Variation\")\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\n## now make a fancy looking plot that shows the PCs and the variation:\nlibrary(ggplot2)\n\n\npca_tau_data <- as.data.frame(pca_tau$x)\npca_tau_data$ID <- rownames(pca_tau)\n\npca_tau_data[1:3,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         PC1        PC2        PC3        PC4         PC5       PC6        PC7\n1 -1.3819533 -0.7723589 -0.1497939 -0.8255788 0.580228997 1.1097423  0.7453586\n2  0.9413986  1.8957482 -1.8432497 -0.5113439 0.006439829 0.3381304 -0.4922156\n3 -2.8051860  0.1268586  1.3089492 -1.4754544 1.383269618 0.3254420 -1.4521685\n          PC8        PC9      PC10       PC11        PC12        PC13\n1 -0.09721616 -0.2145984 1.1261094 -0.1562817  0.07521798 -0.08549565\n2  1.48901252 -1.0289252 0.1594086 -0.4758586  1.11682734 -3.90001841\n3  0.45448119  0.5023209 0.2460753 -1.8408635 -0.90120728  0.50740168\n        PC14       PC15       PC16       PC17       PC18       PC19\n1  0.5876715  0.2571748 -0.4786351  0.3030931  0.6359893 -0.8759168\n2 -1.7626354 -0.6949328 -1.4574158  0.1713398  0.2598557  0.4924712\n3  1.0941291 -0.1581122 -0.4350578 -1.5634038 -0.4342087 -0.2517165\n          PC20       PC21       PC22       PC23       PC24       PC25\n1 -0.028023313 -0.5952623 -0.1414024 -0.7283844  0.8403992 -0.1860633\n2 -0.032765013 -1.5120971 -1.4633075  1.1067587  0.3458078 -0.7956224\n3  0.005762332 -1.5205530 -0.1750097  1.8361136 -0.1698045  0.5892632\n        PC26      PC27       PC28       PC29       PC30       PC31       PC32\n1  0.1242099 0.1995952  0.9042246 -0.2429982  0.5817562 -0.2902614  0.2996957\n2  1.4236614 0.8399747 -0.5923222  2.1732052  0.5287806 -0.6041974  0.8320099\n3 -0.2565404 2.6394070  1.5343056  0.2338289 -0.9271500  1.0454751 -1.1933092\n        PC33       PC34       PC35       PC36       PC37       PC38        PC39\n1  0.4895250 -0.2285274 -0.9431248 -0.3145852 -0.2985718  0.0145554  0.11409038\n2 -1.1517656  0.4853406 -1.3423034 -0.5554157 -0.1993071 -0.2289016 -0.07316783\n3 -0.7428804  0.7343906 -0.4101199 -1.0491344  0.3442827 -0.4879081  0.75944947\n        PC40       PC41       PC42       PC43       PC44       PC45\n1  0.4173199 -0.0738361 -0.7205934  0.5708402  0.4655692 -0.6334262\n2 -1.3263351 -0.3411441  0.8513456 -0.1796426  0.9981185  0.5612230\n3 -0.4137266  0.4624610  0.8652623  0.2884630 -0.2203790 -0.8215023\n          PC46       PC47        PC48       PC49\n1 -0.394740983 -0.8828214  0.09229853 -0.4927227\n2  0.045183409  0.1006513  1.05004595  0.2399484\n3 -0.007963722  0.4694915 -0.58000267  0.6907393\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggplot(pca_tau_data, aes(PC1, PC2)) +\n  geom_point() +\n  xlab(paste(\"PC1 - \", pca_tau_var_per[1], \"%\", sep=\"\")) +\n  ylab(paste(\"PC2 - \", pca_tau_var_per[2], \"%\", sep=\"\")) +\n  theme_bw() +\n  ggtitle(\"Tau PCA Graph\")\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\ntau_loading_scores <- pca_tau$rotation[,1]\ntau_methylation_scores <- abs(tau_loading_scores) # what to do of tau_methylation_scores?\n  \nlibrary(ggfortify)\npca_tau_res <- prcomp(na.omit(tau[c(9:57)]), scale = TRUE)\n\nautoplot(pca_tau_res, data = na.omit(tau[c(1:57)]), colour = 'Zeit',\n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nautoplot(pca_tau_res, data = na.omit(tau[c(1:57)]), colour = 'Gruppe', \n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-3-5.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nautoplot(pca_tau_res, data = na.omit(tau[c(1:57,357)]), colour = 'Sex', \n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-3-6.png){width=672}\n:::\n:::\n\n\n\n## PSD95\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncpg_psd95 <- psd95[10:54]\npca_psd95 <- prcomp(na.omit(cpg_psd95), scale = TRUE)\n\n## plot pc1 and pc2\nplot(pca_psd95$x[,1], pca_psd95$x[,2])\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\n## make a scree plot\npca_psd95_var <- pca_psd95$sdev^2\npca_psd95_var_per <- round(pca_psd95_var/sum(pca_psd95_var)*100, 1)\n\nbarplot(pca_psd95_var_per, main=\"PSD95 Scree Plot\", xlab=\"Principal Component\", ylab=\"Percent Variation\")\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\n## now make a fancy looking plot that shows the PCs and the variation:\nlibrary(ggplot2)\n\n\npca_psd95_data <- as.data.frame(pca_psd95$x)\npca_psd95_data$ID <- rownames(pca_psd95)\n\npca_psd95_data[1:3,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          PC1        PC2        PC3         PC4        PC5         PC6\n1 -2.85879342 -0.2418145 1.20087794 -1.23554615 -1.0082756 -1.66023808\n2  0.04144341  1.7594644 0.35767439  0.48834915 -0.3663842 -0.03269961\n3  0.92326567  0.9665959 0.09710472  0.06864842  0.5617707 -0.76101641\n          PC7        PC8         PC9       PC10       PC11        PC12\n1 -0.28088324  2.7168877 -1.22359032  1.6047574 -0.8404363 -0.41833654\n2 -0.05698023 -0.3950535 -0.33043096  0.1048172 -0.3838444  0.29584449\n3  0.61308021  1.5788723 -0.09993921 -0.8642271 -1.1939783  0.06738369\n         PC13       PC14       PC15       PC16        PC17       PC18\n1 -1.89270715 -0.6642204  3.2744670 -1.8462332  1.69705445  1.2607945\n2 -0.06769426 -0.4101253 -0.4371388  0.1849072 -0.04403083 -0.1511606\n3  0.91016466  1.3808576 -0.3571009  0.3639245 -0.89357025 -0.7817385\n        PC19       PC20       PC21        PC22        PC23       PC24\n1 -0.6613414 -1.8809205 -1.0327169 -1.93435454 -0.04848429  1.3770464\n2 -0.3290592  0.2795013  0.0598549 -0.07629996  0.02122475  0.1202249\n3  1.5815698 -0.9694465  0.0579347 -0.10892581 -0.02161555 -0.4911406\n        PC25      PC26        PC27       PC28       PC29       PC30       PC31\n1 -0.5305166 0.5719533 -0.05301698  0.1186769 -0.3076120 -0.3285893 -0.7448268\n2  0.1086488 0.2768093  0.40568208 -0.2776204 -0.9715391  0.2281850 -0.3490462\n3  1.6244475 0.5386738 -0.79059755 -0.5317878 -0.6690955  0.4897704  0.3564923\n        PC32       PC33       PC34        PC35       PC36        PC37\n1 -0.6494182  0.8940321 -0.6075720  0.38289079 -0.2018711  0.06035272\n2 -0.3914331 -0.6230479  0.2858146 -0.61612144 -0.1577528 -0.72065256\n3 -0.6745935 -1.3116696  0.4726334  0.06182365  0.4844632 -0.61752191\n        PC38        PC39        PC40        PC41       PC42       PC43\n1  0.7158445  0.25142474  0.02882617  0.61527861 0.03760039 -0.1248835\n2 -0.8173084  0.06782867  0.19479037 -0.58568826 0.18121824 -0.3884399\n3 -0.4437899 -0.06860361 -0.30955436 -0.02069936 0.48102956 -0.6925315\n        PC44        PC45\n1 -0.6010115 -0.09819888\n2 -0.4604330 -0.06434912\n3 -0.4227139  0.27316119\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggplot(pca_psd95_data, aes(PC1, PC2)) +\n  geom_point() +\n  xlab(paste(\"PC1 - \", pca_psd95_var_per[1], \"%\", sep=\"\")) +\n  ylab(paste(\"PC2 - \", pca_psd95_var_per[2], \"%\", sep=\"\")) +\n  theme_bw() +\n  ggtitle(\"PSD95 PCA Graph\")\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\npsd95_loading_scores <- pca_psd95$rotation[,1]\npsd95_methylation_scores <- abs(psd95_loading_scores) # what to do of tau_methylation_scores?\n  \nlibrary(ggfortify)\npca_psd95_res <- prcomp(na.omit(psd95[c(10:54)]), scale = TRUE)\n\nautoplot(pca_psd95_res, data = na.omit(psd95[c(1:54)]), colour = 'Zeitpunkt',\n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nautoplot(pca_psd95_res, data = na.omit(psd95[c(1:54)]), colour = 'Gruppe', \n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-4-5.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nautoplot(pca_psd95_res, data = na.omit(psd95[c(1:54,353)]), colour = 'Sex', \n         loadings = TRUE, loadings.colour = 'blue',\n         loadings.label = TRUE, loadings.label.size = 3)\n```\n\n::: {.cell-output-display}\n![](Principal-Component-Analysis_files/figure-html/unnamed-chunk-4-6.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Principal-Component-Analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}